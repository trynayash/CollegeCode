create table employ(empid number(8), empname varchar2(15), depname varchar2(15), salary number(10), gender varchar2(10));

insert into employ values(101,'reema','testing',45000,'female');
insert into employ values(102,'seema','testing',46000,'female');

insert into employ values(103,'tom','support',38000,'male');

insert into employ values(105,'eva','develop',49000,'female');

over() ---> mendatory
partition by --> optional 

lag()
select empname, depname,salary, lag(salary) over(order by salary) from employ; 

select empname, depname,salary, lag(salary) over(order by salary) as prev_sal from employ;

select empname, depname,salary, lag(salary,1) over(order by salary) as prev_sal from employ;

select empname, depname,salary, lag(salary,1,0) over(order by salary) as prev_sal from employ;

select empname, depname,salary, lag(salary,2,0) over(order by salary) as prev_sal from employ;

lag(columnname,offset,default_value) over(partition by columname order by columname[asc/desc])

select empname, depname,salary, lag(salary,1,0) over(partition by depname order by salary) as prev_sal from employ;

lead()
select empname, depname,salary, lead(salary) over(order by salary) from employ; 

select empname, depname,salary, lead(salary) over(order by salary) as next_sal from employ; 
first_value()

select empname, salary, first_value(empname) over(order by salary) from employ; 

select empname, salary, first_value(empname) over(order by salary) as lowest_Sal_emp from employ;

select empname, salary, first_value(empname) over(partition by depname order by salary) as lowest_Sal_emp from employ;

last_value()
select empname, salary, last_value(empname) over(order by salary ) as lowest_sal_emp from employ;

inserting clause--> which is default clause
(rows between unbounded preceding and current row)

select empname, salary, last_value(empname) over(order by salary rows between unbounded preceding and current row) as lowest_sal_emp from employ;

select empname, salary, last_value(empname) over(order by salary rows between unbounded preceding and unbounded following) as lowest_sal_emp from employ;

select empname, salary, last_value(empname) over(partition by depname order by salary rows between unbounded preceding and unbounded following) as lowest_sal_emp from employ;

first--> keep first --> returns lowest value from order list

last--> keep last --> returns highest value from order list 

select empid, empname, depname, salary, min(salary) keep(dense_rank first order by salary) over(partition by depname) as lowest from employ;


select empid, empname, depname, salary, max(salary) keep(dense_rank last order by salary) over(partition by depname) as lowest from employ;


select empid, empname, depname, salary, min(salary) keep(dense_rank first order by salary) over(partition by depname) as lowest,max(salary) keep(dense_rank last order by salary) over(partition by depname) as highest from employ;


NTILE()

select empid, empname,salary, NTILE(2) over(order by salary) from employ;

select empid, empname,salary, NTILE(2) over(order by salary) "RANK" from employ;

select empid, empname,salary, NTILE(3) over(order by salary) "RANK" from employ;




select empid, empno, depno, salary, min(salary) keep(dense_rank first order by salary) over(partition by depno) as lowest,max(salary) keep(dense_rank last order by salary) over(partition by depno) as highest from employ;